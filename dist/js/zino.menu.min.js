!function(c,g){"use strict";var b="menu",f=!1;function e(){this._defaults={dataSource:null,orientation:"horizontal",open:null,close:null,enable:null,disable:null}}e.prototype={_attachMenu:function(i,e){if(this._getInst(i))return f;var t=c(i),n=this,r=n._newInst(t);c.extend(r.settings,n._defaults,e),t.on("mouseenter.menu",".zui-menubar-item",function(e){return n._openMenu.call(n,i,this),!0}).on("mouseleave.menu",".zui-menubar-item",function(e){return n._closeMenu.call(n,i,this),!0}).on("focus.menu",".zui-menubar-item",function(e){return c(".zui-menubar-item[aria-haspopup='true']").not(this).trigger("mouseleave"),c(this).addClass("zui-menubar-item-focus"),!0}).on("blur.menu",".zui-menubar-item",function(e){return c(this).removeClass("zui-menubar-item-focus"),!0}).on("mouseenter.menu",".zui-menu-item",function(e){return c(this).addClass("zui-menu-item-hover"),!0}).on("mouseleave.menu",".zui-menu-item",function(e){return c(this).removeClass("zui-menu-item-hover"),!0}).on("focus.menu",".zui-menu-item",function(e){return!0}).on("blur.menu",".zui-menu-item",function(e){return!0}).on("keydown.menu",".zui-menubar-item",function(e){switch(e.stopPropagation(),e.preventDefault(),e.charCode||e.keyCode||0){case 37:c(e.target).prev().trigger("focus");break;case 38:c(e.target).trigger("mouseenter").find(".zui-menu-item").filter(":last").trigger("focus").trigger("mouseenter");break;case 39:c(e.target).next().trigger("focus");break;case 40:c(e.target).trigger("mouseenter").find(".zui-menu-item").filter(":first").trigger("focus").trigger("mouseenter")}return!0}).on("keydown.menu",".zui-menu-item",function(e){var t;switch(e.stopPropagation(),e.preventDefault(),e.charCode||e.keyCode||0){case 37:c(this).trigger("mouseleave").closest(".zui-menubar-item").prev().trigger("focus").trigger("mouseenter").find(".zui-menu-item").filter(":first").trigger("focus").trigger("mouseenter");break;case 38:(t=(t=c(e.target).prev()).get(0)===g?c(e.target).siblings().filter(":last"):t).trigger("focus").trigger("mouseenter").siblings().removeClass("zui-menu-item-hover");break;case 39:c(this).trigger("mouseleave").closest(".zui-menubar-item").next().trigger("focus").trigger("mouseenter").find(".zui-menu-item").filter(":first").trigger("focus").trigger("mouseenter");break;case 40:(t=(t=c(e.target).next()).get(0)===g?c(e.target).siblings().filter(":first"):t).trigger("focus").trigger("mouseenter").siblings().removeClass("zui-menu-item-hover");break;case 13:case 32:break;case 27:c(e.target).removeClass("zui-menu-item-hover").trigger("blur").closest(".zui-menu").hide().attr("aria-hidden","true").closest(".zui-menubar-item")}return!0}).bind("menuenable",function(e,t){null!==r.settings.enable&&r.settings.enable.call(i,e,t)}).bind("menudisable",function(e,t){null!==r.settings.disable&&r.settings.disable.call(i,e,t)}).bind("menuopen",function(e,t){null!==r.settings.open&&r.settings.open.call(i,e,t)}).bind("menuclose",function(e,t){null!==r.settings.close&&r.settings.close.call(i,e,t)}),c.data(i,b,r),n._renderMenu.call(n,i)},_destroyMenu:function(e){if(!this._getInst(e))return f;var t=c(e);"UL"===e.nodeName?t.removeAttr("role").removeClass("zui-menubar zui-menubar-horizontal zui-menubar-vertical").children("li").removeAttr("role").removeAttr("aria-disabled").removeAttr("aria-haspopup").removeClass("zui-menubar-item zui-menubar-item-hover zui-menubar-item-disabled").children("ul").removeAttr("role").removeAttr("aria-hidden").removeClass("zui-menu").children("li").removeAttr("role").removeAttr("aria-disabled").removeClass("zui-menu-item zui-menu-item-hover"):t.children().remove(),c.data(e,b,f)},getItem:function(e,t){var i;switch(typeof t){case"number":i=(e.hasClass("zui-menubar")?e:c(".zui-menubar",e)).children(".zui-menubar-item").eq(t);break;case"string":i=c(t);break;case"object":t instanceof jQuery?i=t:t.nodeType&&(i=c(t))}return i},_enableMenu:function(e,t){var i;return!this._getInst(e)||(e=c(e),"false"===(i=this.getItem(e,t)).attr("aria-disabled"))?f:(i.attr("aria-disabled","false").removeClass("zui-menubar-item-disabled"),void e.trigger("menuenable",{index:t}))},_disableMenu:function(e,t){var i;return!this._getInst(e)||(e=c(e),"true"===(i=this.getItem(e,t)).attr("aria-disabled"))?f:(i.attr("aria-disabled","true").addClass("zui-menubar-item-disabled"),i.children(".zui-menu").is(":visible")&&i.trigger("mouseleave"),void e.trigger("menudisable",{index:t}))},_closeMenu:function(e,t){var i;return this._getInst(e)&&(e=c(e),(i=this.getItem(e,t)).removeClass("zui-menubar-item-hover"),(i=i.children(".zui-menu")).is(":visible"))?(i.hide().attr("aria-hidden","true"),void e.trigger("menuclose",{index:t})):f},_openMenu:function(e,t){var i,n;return!this._getInst(e)||(e=c(e),(n=(i=this.getItem(e,t)).children(".zui-menu")).is(":visible"))||"true"===i.attr("aria-disabled")?f:(i.addClass("zui-menubar-item-hover"),n.show().attr("aria-hidden","false"),void e.trigger("menuopen",{index:t}))},_renderMenu:function(e){var n=this._getInst(e);if(!n)return f;var r,a,u,s,o,l,m,d=c(e);if("UL"===e.nodeName){switch(d.attr("role","menubar").addClass("zui-menubar").find("ul").hide(),n.settings.orientation){case"horizontal":d.addClass("zui-menubar-horizontal");break;case"vertical":d.addClass("zui-menubar-vertical")}d.children("li").attr({role:"menuitem","aria-disabled":"false"}).addClass("zui-menubar-item").each(function(e,t){c(t).attr("aria-haspopup",c(t).children("ul").get(0)!=g?"true":"false").attr("tabindex",0<e?-1:0)}).end().find("ul").attr("role","menu").addClass("zui-menu").children("li").attr("tabindex",-1).attr({role:"menuitem","aria-disabled":"false"}).addClass("zui-menu-item")}else n.settings.dataSource.load(function(e){r=c("<ul>",{role:"menubar"}).addClass("zui-menubar zui-menubar-"+n.settings.orientation);var t=e,i=r;for(s=m=0,o=t.length;s<o;s++)if(0==t[s].parent_id){for(u=c("<li>").attr("role","menuitem").attr("tabindex",0<m?-1:0).addClass("zui-menubar-item"),c("<a>",{href:t[s].url}).html(t[s].text).appendTo(u),a=c("<ul>",{"aria-hidden":"true",role:"menu"}).hide().addClass("zui-menu"),l=0;l<o;l++)t[l].parent_id==t[s].id&&c("<li>").attr("role","menuitem").attr("tabindex",-1).addClass("zui-menu-item").append(c("<a>",{href:t[l].url}).html(t[l].text)).appendTo(a);a.children().get(0)!=g?(a.appendTo(u),u.attr("aria-haspopup","true")):u.attr("aria-haspopup","false"),u.appendTo(i),m+=1}r.appendTo(d)});c.data(e,b,n)},_newInst:function(e){return{id:e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:e,uid:Math.floor(99999999*Math.random()),isDisabled:f,settings:{}}},_getInst:function(e){try{return c.data(e,b)}catch(e){throw"Missing instance data for this menu"}}},c.fn.zinoMenu=function(e){var t=Array.prototype.slice.call(arguments,1);return"string"==typeof e&&"isDisabled"===e||"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?c.zinoMenu["_"+e+"Menu"].apply(c.zinoMenu,[this[0]].concat(t)):this.each(function(){"string"==typeof e?c.zinoMenu["_"+e+"Menu"].apply(c.zinoMenu,[this].concat(t)):c.zinoMenu._attachMenu(this,e)})},c.zinoMenu=new e,c.zinoMenu.version="1.5"}(jQuery);