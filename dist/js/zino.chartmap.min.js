!function(S,i){"use strict";var n="chartmap",A={},T=!1;function e(){A.$body=S(document.body),A.margin=A.$body.offset(),A.padding={left:Number(A.$body.css("paddingLeft").replace("px","")),top:Number(A.$body.css("paddingTop").replace("px",""))}}function M(){this._defaults={plugin:"svg",map:"BG",fill:"#5DC1E4",hover:"#957030",background:"#FFFFFF",palette:!0,provinces:!0,font:{family:"Arial",size:"12px"},tooltip:{color:"#fff",fill:"#000",radius:0,opacity:1,offset:{x:15,y:15},pattern:"%name"},legend:[],zoom:11,width:530,height:320,click:null}}S(function(){e.call(null)}),S(window).on("resize",function(t){e.call(null)});var F={cutHex:function(t){return"#"==t.charAt(0)?t.substring(1,7):t},hexToR:function(t){return parseInt(F.cutHex(t).substring(0,2),16)},hexToG:function(t){return parseInt(F.cutHex(t).substring(2,4),16)},hexToB:function(t){return parseInt(F.cutHex(t).substring(4,6),16)},hexToRgb:function(t){return[F.hexToR(t),F.hexToG(t),F.hexToB(t)]},rgbToHex:function(t,e,i){return["#",F.toHex(t),F.toHex(e),F.toHex(i)].join("")},toHex:function(t){if(t=parseInt(t,10),isNaN(t))return"00";t=Math.max(0,Math.min(t,255));var e="0123456789ABCDEF";return[e.charAt((t-t%16)/16),e.charAt(t%16)].join("")},rgbToHsv:function(t,e,i){if(t=parseInt((""+t).replace(/\s/g,""),10),e=parseInt((""+e).replace(/\s/g,""),10),i=parseInt((""+i).replace(/\s/g,""),10),null===t||null===e||null===i||isNaN(t)||isNaN(e)||isNaN(i))return T;if(t<0||e<0||i<0||255<t||255<e||255<i)return T;t/=255,e/=255,i/=255;var n=Math.min(t,Math.min(e,i)),s=Math.max(t,Math.max(e,i));return n===s?[0,0,n]:[60*((t===n?3:i===n?1:5)-(t===n?e-i:i===n?t-e:i-t)/(s-n)),(s-n)/s,s]},hsvToRgb:function(t){var e,i,n;if(0===t[1])e=i=n=Math.round(2.55*t[2]);else{t[0]/=60;var s=Math.floor(t[0]),a=t[0]-s,o=t[2]*(1-t[1]),r=t[2]*(1-t[1]*a),l=t[2]*(1-t[1]*(1-a));switch(s){case 0:e=t[2],i=l,n=o;break;case 1:e=r,i=t[2],n=o;break;case 2:e=o,i=t[2],n=l;break;case 3:e=o,i=r,n=t[2];break;case 4:e=l,i=o,n=t[2];break;default:e=t[2],i=o,n=r}e=Math.round(255*e),i=Math.round(255*i),n=Math.round(255*n)}return[e,i,n]},hueShift:function(t,e){for(t+=e;360<=t;)t-=360;for(;t<0;)t+=360;return t},complementary:function(t){var t=t.match(/[0-9a-fA-F]+/)?F.hexToRgb(t):t,e=F.rgbToHsv(t[0],t[1],t[2]);return e[0]=F.hueShift(e[0],180),t=F.hsvToRgb(e),F.rgbToHex(t[0],t[1],t[2])}};M.getWebsafeColors=function(){for(var t,e,i=[],n=["00","33","66","99","CC","FF"],s=0;s<6;s++)for(t=0;t<6;t++)for(e=0;e<6;e++)i.push(["#",n[s],n[t],n[e]].join(""));return i},M.getColorLuminance=function(t,e){(t=String(t).replace(/[^0-9a-f]/gi,"")).length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;for(var i,n="#",s=0;s<3;s++)i=parseInt(t.substr(2*s,2),16),n+=("00"+(i=Math.round(Math.min(Math.max(0,i+i*e),255)).toString(16))).substr(i.length);return n},M.getColors=function(t){var e=["#3366CC","#DC3912","#067A06","#FFCC00","#663300","#660066","#3399CC","#CC6600","#CC3399","#CC6666","#339900","#CC99FF","#CC3300","#99FF66","#993366","#16448A"];return t!==i&&e[t]!==i?e[t]:e},M.getColorPalette=function(t,e){var i=0,n="up",s=.2,a=[];switch(arguments.length){case 3:n=arguments[2];break;case 4:n=arguments[2],s=arguments[3]}for(var o=0;o<e;o+=1)"up"==n?i+=s:i-=s,a.push(M.getColorLuminance(t,i));return a},M.prototype={_attachChartmap:function(t,e){if(this._getInst(t))return T;var i=S(t),i=this._newInst(i);S.extend(i.settings,this._defaults,e),i.settings.earthRadius=6378137,i.settings.index=i.settings.earthRadius/Math.max(i.settings.width,i.settings.height),i.settings.wIndex=i.settings.earthRadius/i.settings.width,i.settings.hIndex=i.settings.earthRadius/i.settings.height,"svg"===i.settings.plugin&&(i.handle=zino.Svg({target:t,width:i.settings.width,height:i.settings.height,viewBox:"0 0 WW HH".replace("WW",i.settings.width).replace("HH",i.settings.height),preserveAspectRatio:"xMidYMid meet",namespaces:{zui:"http://zinoui.com/svgns"}}),i.handle.desc("Created with ZinoUI "+S.zinoChartmap.version),e=i.handle.clipPath("zinoui-1").getShape(),i.handle.rect(0,0,0,0,i.settings.width,i.settings.height,!1).attr({fill:"none"}).appendTo(e)),S.data(t,n,i),this.draw.call(this,t)},draw:function(t){var e=this._getInst(t);if(!e)return T;"svg"===e.settings.plugin&&e.handle.rect(0,0,0,0,e.settings.width,e.settings.height).attr({fill:e.settings.background.length?e.settings.background:"none",stroke:"none","stroke-width":0}).insert(),this.map.call(this,t)},map:function(t){var r=this._getInst(t);if(!r)return T;if(!(r.settings.map in zino.Chartmap.countries))throw new Error(["Please verify that ",r.settings.map,".js is loaded."].join(""));var n,e,i,s,a,o,l,g,h,p,d,u,c=zino.Chartmap.countries[r.settings.map],f=parseInt(c.scale),m=M.getColorPalette(r.settings.fill,c.provinces.length,"down",.005);M.getColors();function b(t,e){var i=S(e),n=i.attr("fill"),s=e.getAttributeNS("zui","hover");i.data("fill",n),e.setAttributeNS(null,"fill",s||r.settings.hover||F.complementary(n)),r.settings.tooltip&&(g.firstChild.firstChild.nodeValue=e.getAttributeNS("zui","tooltip"),i=g.getBBox(),l.setAttributeNS(null,"width",Number(i.width)+10),l.setAttributeNS(null,"height",Number(i.height)+10),y.setAttributeNS(null,"visibility","visible"))}function v(t,e){e.setAttributeNS(null,"fill",S(e).data("fill")),r.settings.tooltip&&y.setAttributeNS(null,"visibility","hidden")}function x(t,e){var i,n,s,a,o;r.settings.tooltip&&(i=t.clientX,t=t.clientY,s=n=0,a=parseInt(l.getAttributeNS(null,"width"),10),o=parseInt(l.getAttributeNS(null,"height"),10),isNaN(r.settings.tooltip.offset.x)||(n=r.settings.tooltip.offset.x),isNaN(r.settings.tooltip.offset.y)||(s=r.settings.tooltip.offset.y),i-=A.margin.left+A.padding.left,(t-=A.margin.top+A.padding.top)+o+s>r.settings.height&&(t-=o+s),i+a+n>r.settings.width&&(i-=a+n),y.setAttributeNS(null,"transform",["translate(",i,",",t,")"].join("")))}function C(t,e){r.settings.click&&r.settings.click.call(this,t,e)}if("svg"===r.settings.plugin){if(N=r.handle.g().attr({class:"zui-chartmap-map",visibility:"hidden",transform:"translate(XX,YY) scale(ZOOMX,ZOOMY)".replace("XX",-c.minx*f/r.settings.index*r.settings.zoom).replace("YY",c.maxy*f/r.settings.index*r.settings.zoom).replace(/ZOOMX/g,+parseFloat(r.settings.zoom)).replace(/ZOOMY/g,-1*parseFloat(r.settings.zoom))}),o=N.getShape(),r.settings.provinces)for(n=0,e=c.provinces.length;n<e;n+=1)for(i=0,s=c.provinces[n].polygon.length;i<s;i+=1)(a=c.provinces[n].polygon[i].split(" ")).forEach(function(t,e,i){i[e]=(parseFloat(t)*f/r.settings.index).toFixed(2),isNaN(i[e])}),h=r.settings.palette?m[n]||M.getColorLuminance(r.settings.fill,1-n/10):r.settings.fill,p=r.settings.hover,0<r.settings.provinces.length&&r.settings.provinces.forEach(function(t,e,i){"string"==typeof t&&t==c.provinces[n].id?(h=r.settings.fill,p=r.settings.hover):t.id&&t.id==c.provinces[n].id&&(h=t.fill||r.settings.fill,p=t.hover||r.settings.hover)}),r.handle.polygon(a.join(" ")).attr({"zui:tooltip":r.settings.tooltip.pattern?r.settings.tooltip.pattern.replace("%name",c.provinces[n].name):c.provinces[n].name,id:c.provinces[n].id,fill:h,"zui:hover":p}).bind("mouseenter",b).bind("mouseleave",v).bind("mousemove",x).bind("click",C).appendTo(o);else for(n=0,e=c.country.length;n<e;n+=1)(a=c.country[n].split(" ")).forEach(function(t,e,i){i[e]=(parseFloat(t)*f/r.settings.index).toFixed(2)}),r.handle.polygon(a.join(" ")).attr({"zui:tooltip":r.settings.tooltip.pattern?r.settings.tooltip.pattern.replace("%name",c.name):c.name,fill:r.settings.fill,"zui:hover":r.settings.hover}).bind("mouseenter",b).bind("mouseleave",v).bind("mousemove",x).bind("click",C).appendTo(o);var y,N,w,z=r.handle.g().append(o).getShape();setTimeout(function(){u=o.getBoundingClientRect(),d=(r.settings.width-u.width)/2,(u=(r.settings.height-u.height)/2)<0&&(u=0),z.setAttributeNS(null,"transform","translate(XX,YY)".replace("XX",d).replace("YY",u)),o.setAttributeNS(null,"visibility","visible")},1),r.settings.legend&&this._showLegendChartmap.call(this,t),r.settings.tooltip&&(y=r.handle.g().attr({class:"zui-chartmap-tooltip",visibility:"hidden",transform:"translate(0,0)"}).getShape(),w=t=N=0,isNaN(r.settings.tooltip.offset.x)||(N=r.settings.tooltip.offset.x),isNaN(r.settings.tooltip.offset.y)||(t=r.settings.tooltip.offset.y),!isNaN(r.settings.tooltip.radius)&&0<=r.settings.tooltip.radius&&(w=r.settings.tooltip.radius),l=r.handle.rect(N,t,w,w,100,22,!1).attr({fill:r.settings.tooltip.fill,opacity:r.settings.tooltip.opacity}).appendTo(y).getShape(),g=r.handle.factory("text",!1).attr({x:N+5,y:t+5,fill:r.settings.tooltip.color,"font-family":r.settings.font.family,"font-size":r.settings.font.size,"text-anchor":"start","dominant-baseline":"text-before-edge"}).appendTo(y).getShape(),w=r.handle.factory("tspan",!1).attr({"alignment-baseline":"text-before-edge"}).appendTo(g).getShape(),r.handle.textNode("",!1).appendTo(w))}},_hideLegendChartmap:function(t){if(!this._getInst(t))return T;S(t).find(".zui-chartmap-legend").remove()},_showLegendChartmap:function(t){var e=this._getInst(t);if(!e)return T;var i=0;if(i=e.settings.legend.items?e.settings.legend.items.length:i){var n,s,a,o,r,l=0,g=0,h=[],p=0,d=0;M.getColors();for("svg"===e.settings.plugin&&(a=e.handle.g().attr({class:"zui-chartmap-legend"}).getShape(),e.handle.rect(0,0,0,0,0,0,!1).attr({fill:e.settings.legend.fill.length?e.settings.legend.fill:"none"}).appendTo(a)),n=0;n<i;n++)"svg"===e.settings.plugin&&(e.handle.rect(0,10,0,0,12,12,!1).attr({fill:e.settings.legend.items[n].fill,stroke:"none","stroke-width":0}).appendTo(a),o=e.handle.factory("text",!1).attr({x:0,y:10,fill:e.settings.legend.color,"font-family":e.settings.font.family,"font-size":e.settings.font.size,"text-anchor":"start","dominant-baseline":"text-before-edge"}).appendTo(a).getShape(),r=e.handle.factory("tspan",!1).attr({"alignment-baseline":"text-before-edge"}).appendTo(o).getShape(),e.handle.textNode(e.settings.legend.items[n].label,!1).appendTo(r),r=o.getBoundingClientRect(),h[1+2*n]=15,h[1+2*n+1]=r.width+5,g=g+h[1+2*n]+h[1+2*n+1],l=r.height);switch(e.settings.legend.position){case"top":p=15;break;case"bottom":p=e.settings.height-l-15}switch(e.settings.legend.alignment){case"left":d=15;break;case"middle":d=(e.settings.width-g)/2;break;case"right":d=e.settings.width-g-15}if("svg"===e.settings.plugin)for(n=s=0,i=a.childNodes.length;n<i;n+=1)0<n?(a.childNodes[n].setAttributeNS(null,"x",d+s),a.childNodes[n].setAttributeNS(null,"y",p),s+=h[n]):(a.childNodes[n].setAttributeNS(null,"width",g+10),a.childNodes[n].setAttributeNS(null,"height",l+10),a.childNodes[n].setAttributeNS(null,"x",d-5),a.childNodes[n].setAttributeNS(null,"y",p-5))}},_newInst:function(t){return{id:t[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:t,uid:Math.floor(99999999*Math.random()),isDisabled:T,settings:{}}},_getInst:function(t){try{return S.data(t,n)}catch(t){throw"Missing instance data for this chartmap"}}},S.fn.zinoChartmap=function(t){var e=Array.prototype.slice.call(arguments,1);return"string"==typeof t&&"isDisabled"===t||"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?S.zinoChartmap["_"+t+"Chartmap"].apply(S.zinoChartmap,[this[0]].concat(e)):this.each(function(){"string"==typeof t?S.zinoChartmap["_"+t+"Chartmap"].apply(S.zinoChartmap,[this].concat(e)):S.zinoChartmap._attachChartmap(this,t)})},S.zinoChartmap=new M,S.zinoChartmap.version="1.5.1",window.zino=window.zino||{},window.zino.Chartmap={countries:{}}}(jQuery);