!function(k,F){"use strict";var N="calendar",O=!1,e=new Date,I=[e.getFullYear(),e.getMonth(),e.getDate()].join("-"),Y=new Date(e.getFullYear(),e.getMonth(),e.getDate()),x=window.document;function j(e){for(var t=e?8:7,a=k("<tr>"),n=0;n<t;n++)k("<td>").addClass("zui-calendar-empty").appendTo(a);return a}function A(e,t){return 0<e&&e<t-1?0:0<e&&e===t-1?2:0===e&&e===t-1?3:0===e&&e<t-1?1:void 0}function s(e,t){var a=Object.prototype.toString.call(t).slice(8,-1);return t!==F&&null!==t&&a===e}function t(){this.id=null,this.selectedDate=null,this._state=[],this._defaults={year:(new Date).getFullYear(),month:(new Date).getMonth(),dayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],dayNamesFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthNamesFull:["January","February","March","April","May","June","July","August","September","October","November","December"],startDay:0,weekNumbers:!1,selectOtherMonths:!1,showOtherMonths:!0,showNavigation:!0,months:1,inline:!1,disablePast:!1,dateFormat:"Y-m-d",position:"bottom",minDate:null,beforeOpen:null,beforeClose:null,open:null,close:null,select:null,onBeforeShowDay:function(){return[!0,""]}}}t.prototype={_attachCalendar:function(a,e){if(this._getInst(a))return O;for(var t=k(a),n=this,s=n._newInst(t),r=(k.extend(s.settings,n._defaults,e),0),i=(1===a.nodeType&&"INPUT"==a.nodeName&&0<a.value.length&&(e=function(e,t){for(var a,n,s,r,i,l=[".","-","/"],o=0,d=l.length;o<d;o++)if(-1!==e.indexOf(l[o]))return r=e.split(l[o]),i=t.split(l[o]),a=k.inArray("Y",i),n=k.inArray("m",i),s=k.inArray("d",i),-1===n&&(n=k.inArray("n",i)),-1===s&&(s=k.inArray("j",i)),[r[a],r[n],r[s]].join("-");return e}(a.value,s.settings.dateFormat).split("-"),e=new Date(parseInt(e[0],10),parseInt(e[1],10)-1,parseInt(e[2],10)),i=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),s.settings.year=i.getFullYear(),s.settings.month=i.getMonth(),n.selectedDate=e),a.style.cursor="pointer",k("<div>",{id:["zui-calendar-container",s.uid].join("-")}).addClass("zui-calendar-container")),l=(s.settings.inline?i.appendTo(a):(i.css({display:"none",position:"absolute"}),t.bind("focus.calendar",function(e){(s.isOpen?n._closeCalendar:n._openCalendar).call(n,a)}).bind("blur.calendar",function(e){s.isOpen&&!s.focus&&n._closeCalendar.call(n,a)}).bind("keydown.calendar",function(e){switch(e.charCode||e.keyCode||0){case 9:case 27:n._closeCalendar.call(n,a)}}).bind("calendarbeforeOpen",function(e,t){null!==t.settings.beforeOpen&&t.settings.beforeOpen.call(a,e,t)}).bind("calendarbeforeClose",function(e,t){null!==t.settings.beforeClose&&t.settings.beforeClose.call(a,e,t)}).bind("calendaropen",function(e,t){null!==t.settings.open&&t.settings.open.call(a,e,t)}).bind("calendarclose",function(e,t){null!==t.settings.close&&t.settings.close.call(a,e,t)}),k("document").bind("mousedown.calendar",function(e){var t,e=k(((e=(e=e)||window.event).target?t=e.target:e.srcElement&&(t=e.srcElement),t=3==t.nodeType?t.parentNode:t));e.hasClass("zui-calendar-container")||e.hasClass("zui-calendar-table")||e.hasClass("zui-calendar-date")||e.hasClass("zui-calendar-today")||e.hasClass("zui-calendar-empty")||e.hasClass("zui-calendar-selected")||e.hasClass("zui-calendar-week")||e.hasClass("zui-calendar-nav")||e.hasClass("zui-calendar-navi")||e.hasClass("zui-calendar-month")||e.hasClass("zui-calendar-wday")||e.hasClass("zui-calendar-wnum")||e.parent().hasClass("zui-calendar-container")||e.parent().hasClass("zui-calendar-table")||n._closeCalendar.call(n,a)}),i.appendTo("body")),t.bind("calendarselect",function(e,t){null!==t.settings.select&&t.settings.select.call(a,e,t)}),s.container=i,k.data(a,N,s),s.settings.year),o=s.settings.month,r=0;r<s.settings.months;r++)n._drawCalendar(a,l,o+r,A(r,s.settings.months));k(s.container).on("click",".zui-calendar-date",function(){var e=k(this),e=(k("td",s.container).removeClass("zui-calendar-selected"),e.addClass("zui-calendar-selected"),parseInt(e.attr("zui-calendar-date"),10));n.selectedDate=new Date(e),s.settings.year=n.selectedDate.getFullYear(),s.settings.month=n.selectedDate.getMonth(),s.settings.inline||(n._closeCalendar.call(n,a),a.value=n.formatDate(s.settings.dateFormat,e)),t.trigger("calendarselect",s),n._refreshCalendar.call(n,a)})},formatDate:function(){return function(e,t){function a(e){return 2===(e+"").length?e:"0"+e}for(var n,s=[],r=new Date(t),i=0,l=e.length;i<l;i++)switch(n=e.charAt(i)){case"Y":s.push(r.getFullYear());break;case"y":s.push((r.getFullYear()+"").slice(-2));break;case"m":s.push(a(r.getMonth()+1));break;case"n":s.push(r.getMonth()+1);break;case"F":s.push(this.opts.monthNamesFull[r.getMonth()]);break;case"M":s.push(this.opts.monthNames[r.getMonth()]);break;case"d":s.push(a(r.getDate()));break;case"j":s.push(r.getDate());break;case"D":s.push(this.opts.dayNamesFull[r.getDay()].slice(0,3));break;case"l":s.push(this.opts.dayNamesFull[r.getDay()]);break;default:s.push(n)}return s.join("")}.apply(this,arguments)},_drawCalendar:function(t,a,n,e,s){var r=this._getInst(t);if(!r)return O;var i,l,o,d,c,u,g=this,s=s===F?Math.floor(9999999*Math.random()):s,h=new Date(a,n,1),p=new Date(a,n+1,0).getDate(),f=new Date(a,n,0).getDate(),m=h.getUTCDay(),C=h.getDay(),y=0,b=r.settings.weekNumbers?8:7,w=k("<table>"),z=k("<thead>"),D=k("<tbody>"),v=!1;for(null!==r.settings.minDate&&(v=!0),o=k("<tr>"),M=k("<th>"),!r.settings.showNavigation||1!==e&&3!==e?M.addClass("zui-calendar-navi"):(M.click(function(e){for(k("#zui-calendar-container-"+r.uid).html(""),i=0;i<r.settings.months;i++)g._drawCalendar(t,a,n-r.settings.months+i,A(i,r.settings.months)),0===i&&(r.settings.month=n-r.settings.months,r.settings.year=a)}),M.addClass("zui-calendar-nav zui-unselectable").css({cursor:"pointer"}).text("<")),M.appendTo(o),M=k("<th>",{colSpan:7==b?5:6}).addClass("zui-calendar-month").text(r.settings.monthNamesFull[h.getMonth()]+" "+h.getFullYear()).appendTo(o),M=k("<th>"),!r.settings.showNavigation||2!==e&&3!==e?M.addClass("zui-calendar-navi"):M.css({cursor:"pointer"}).addClass("zui-calendar-nav zui-unselectable").text(">").click(function(e){for(k("#zui-calendar-container-"+r.uid).html(""),i=0;i<r.settings.months;i++)g._drawCalendar(t,a,n+i+1,A(i,r.settings.months)),0===i&&(r.settings.month=n+1,r.settings.year=a)}),M.appendTo(o),o.appendTo(z),o=k("<tr>"),r.settings.weekNumbers&&(M=k("<th>").text("wk").addClass("zui-calendar-wnum").appendTo(o)),i=0;i<7;i++)M=k("<th>").text(r.settings.dayNames[(r.settings.startDay+i)%7]).addClass("zui-calendar-wday").appendTo(o);for(o.appendTo(z),z.appendTo(w),l=r.settings.startDay+1-C;1<l;)l-=7;for(;l<=p;){for(c=new Date(a,n,l+m),o=k("<tr>"),r.settings.weekNumbers&&(M=k("<td>").addClass("zui-calendar-week"),c=new Date(c.getFullYear(),c.getMonth(),c.getDate()-(c.getDay()||7)+3),d=new Date(c.getFullYear(),0,4),M.text(1+Math.round((c-d)/864e5/7)).appendChild(o)),i=0;i<7;i++){var _,T,M=k("<td>");0<l&&l<=p?(u=new Date(a,n,l),M.attr("zui-calendar-date",u.getTime()).addClass("zui-calendar-date"),I===[u.getFullYear(),u.getMonth(),u.getDate()].join("-")&&M.addClass("zui-calendar-today"),M.text(l),T=r.settings.onBeforeShowDay.apply(g,[u]),!0===r.settings.disablePast&&u<Y||v&&u<r.settings.minDate?M.addClass("zui-calendar-past"):!1===T[0]&&M.addClass(T[1])):(r.settings.showOtherMonths&&(T=0<l?n+1:n-1,M.text(_=0<l?l-p:f+l),u=new Date(a,T,_),M.attr("zui-calendar-date",u.getTime()),r.settings.selectOtherMonths),M.addClass("zui-calendar-empty")),null!==g.selectedDate&&g.selectedDate.getTime()===u.getTime()&&r.settings.month===n&&M.addClass("zui-calendar-selected"),M.appendTo(o),o.appendTo(D),l++}y++}5===y?j(r.settings.weekNumbers).appendTo(D):4===y&&(j(r.settings.weekNumbers).appendTo(D),j(r.settings.weekNumbers).appendTo(D)),w.addClass("zui-calendar-table"),w.attr("id",["zui-calendar-table",s].join("-")),D.appendTo(w),w.click(function(e){r.focus=!0});b=x.getElementById(["zui-calendar-table",s].join("-"));b&&r.container.remove(b),w.appendTo(r.container),k.data(t,N,r)},_openCalendar:function(e){var t=this._getInst(e);if(!t)return O;var a=function(e){var t=0,a=0;if(e.offsetParent){for(;t+=e.offsetLeft,a+=e.offsetTop,e=e.offsetParent;);return[t,a]}}(e),n=k(e);switch(n.trigger("calendarbeforeOpen",t),t.settings.position){case"bottom":t.container.css({top:a[1]+e.offsetHeight+"px"});break;case"top":t.container.show(),t.container.css({top:a[1]-t.container.offsetHeight+"px"})}t.container.css({left:a[0]+"px"}),t.container.show(),n.trigger("calendaropen",t),t.isOpen=!0,t.focus=!0,k.data(e,N,t)},_closeCalendar:function(e){var t=this._getInst(e);if(!t)return O;var a=k(e);a.trigger("calendarbeforeClose",t),t.container.hide(),a.trigger("calendarclose",t),t.isOpen=!1,t.focus=!1,k.data(e,N,t)},_destroyCalendar:function(e){var t=this._getInst(e);if(!t)return O;e.style.cursor="text",t.container.parent().remove(t.container),k.data(e,N,t)},_optionCalendar:function(e,t){var a=this._getInst(e);if(!a)return O;switch(arguments.length){case 2:if(s("String",t)&&a.settings[t])return a.settings[t];if(s("Object",t))for(var n in t)t.hasOwnProperty(n)&&(a.settings[n]=t[n]);break;case 3:a.settings[t]&&(a.settings[t]=arguments[2])}k.data(e,N,a)},_refreshCalendar:function(e){var t=this._getInst(e);if(!t)return O;var a,n=t.settings.year,s=t.settings.month;for(t.container.html(""),a=0;a<t.settings.months;a++)this._drawCalendar(e,n,s+a,A(a,t.settings.months));k.data(e,N,t)},_newInst:function(e){return{id:e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:e,uid:Math.floor(99999999*Math.random()),focus:O,isOpen:O,isDisabled:O,settings:{}}},_getInst:function(e){try{return k.data(e,N)}catch(e){throw"Missing instance data for this calendar"}}},k.fn.zinoCalendar=function(e){var t=Array.prototype.slice.call(arguments,1);return"string"==typeof e&&"isDisabled"===e||"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?k.zinoCalendar["_"+e+"Calendar"].apply(k.zinoCalendar,[this[0]].concat(t)):this.each(function(){"string"==typeof e?k.zinoCalendar["_"+e+"Calendar"].apply(k.zinoCalendar,[this].concat(t)):k.zinoCalendar._attachCalendar(this,e)})},k.zinoCalendar=new t,k.zinoCalendar.version="1.5"}(jQuery);