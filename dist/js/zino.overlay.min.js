!function(v,f){"use strict";var y="overlay",p="zui-overlay-",z=!1;function b(){var e,t=void 0!==window.innerWidth?(e=window.innerWidth,window.innerHeight):(void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(e=document.documentElement.clientWidth,document.documentElement):(e=document.body.clientWidth,document.body)).clientHeight;return{width:parseInt(e,10),height:parseInt(t,10)}}function w(){var e,t,i;return i=void 0!==window.pageYOffset?(t=window.pageYOffset,window.pageXOffset):(i=document.body,t=(e=(e=document.documentElement).clientHeight?e:i).scrollTop,e.scrollLeft),{top:parseInt(t,10),left:parseInt(i,10)}}function e(){this.curInst=null,this.data={},this._defaults={width:320,height:240,autoOpen:!1,modal:!1,header:!0,footer:!0,resizable:!1,draggable:!1,maximized:!1,minimized:!1,minWidth:150,minHeight:150,maxWidth:!1,maxHeight:!1,toolbar:{minimize:!0,maximize:!0,close:!0},buttons:{Ok:function(){v(this).zinoOverlay("close")}},beforeOpen:null,beforeClose:null,open:null,close:null,minimize:null,maximize:null,restore:null,drag:null,dragstart:null,dragend:null,resize:null,resizestart:null,resizeend:null},this.body=document.getElementsByTagName("body")[0],this.html=document.getElementsByTagName("html")[0],this.body&&(this.overflow_body=this.body.style.overflow),this.overflow_html=this.html.style.overflow}e.prototype={_attachOverlay:function(i,e){if(this._getInst(i))return z;var t,n,s,o,a,l,r,d,h,u,c=v(i),g=this,m=g._newInst(c);b(),w();for(d in v.extend(m.settings,g._defaults,e),c.bind("overlayopen",function(e,t){null!==m.settings.open&&m.settings.open.call(i,e,t)}).bind("overlayclose",function(e,t){null!==m.settings.close&&m.settings.close.call(i,e,t)}).bind("overlayminimize",function(e,t){null!==m.settings.minimize&&m.settings.minimize.call(i,e,t)}).bind("overlaymaximize",function(e,t){null!==m.settings.maximize&&m.settings.maximize.call(i,e,t)}).bind("overlayrestore",function(e,t){null!==m.settings.restore&&m.settings.restore.call(i,e,t)}).bind("overlaydrag",function(e,t){null!==m.settings.drag&&m.settings.drag.call(i,e,t)}).bind("overlaydragstart",function(e,t){null!==m.settings.dragstart&&m.settings.dragstart.call(i,e,t)}).bind("overlaydragend",function(e,t){null!==m.settings.dragend&&m.settings.dragend.call(i,e,t)}).bind("overlayresize",function(e,t){null!==m.settings.resize&&m.settings.resize.call(i,e,t)}).bind("overlayresizestart",function(e,t){null!==m.settings.resizestart&&m.settings.resizestart.call(i,e,t)}).bind("overlayresizeend",function(e,t){null!==m.settings.resizeend&&m.settings.resizeend.call(i,e,t)}),e=v("<div>").attr({id:[p,"container-",m.uid].join("")}).addClass([p,"container"].join("")),t=v("<div>").attr({id:[p,"wrapper-",m.uid].join("")}).addClass([p,"wrapper"].join("")),n=v("<div>").attr({id:[p,"holder-",m.uid].join(""),role:"dialog"}).addClass([p,"holder"].join("")),s=v("<div>").attr({id:[p,"header-",m.uid].join("")}).addClass([p,"header zui-unselectable"].join("")),v("<div>").addClass("zui-overlay-header-title").html(c.attr("title")).appendTo(s),o=v("<div>").addClass("zui-overlay-header-toolbar"),a=v("<div>").attr({id:[p,"content-",m.uid].join("")}).addClass([p,"content"].join("")).html(c.html()),l=v("<div>").attr({id:[p,"footer-",m.uid].join("")}).addClass([p,"footer"].join("")).append(v("<div>").addClass("zui-overlay-footer-inner")),m.settings.buttons)m.settings.buttons.hasOwnProperty(d)&&(r=v("<input>").attr({type:"button"}).val(d).click(function(t,i){return function(e){m.settings.buttons[t].apply(i,[this])}}(d,i)).appendTo(l.find(".zui-overlay-footer-inner")),v.fn.zinoButton!==f)&&r.zinoButton();if(m.settings.toolbar.minimize&&(h=v("<span>").addClass([p,"toolbar-icon ",p,"minimize"].join("")),u=v("<span>").addClass([p,"toolbar-icon ",p,"restore"].join("")),v("<a>").addClass([p,"toolbar-link"].join("")).attr({href:"#"}).click(function(e){return e&&e.preventDefault&&e.preventDefault(),g._minimizeOverlay.call(g,i,this),!1}).append(h).appendTo(o),v("<a>").addClass([p,"toolbar-link"].join("")).attr({href:"#"}).hide().click(function(e){return e&&e.preventDefault&&e.preventDefault(),g._restoreOverlay.call(g,i,this),!1}).append(u).appendTo(o)),m.settings.toolbar.maximize&&(h=v("<span>").addClass([p,"toolbar-icon ",p,"maximize"].join("")),v("<a>").attr({href:"#"}).addClass([p,"toolbar-link"].join("")).click(function(e){return e&&e.preventDefault&&e.preventDefault(),g._maximizeOverlay.call(g,i,this),!1}).append(h).appendTo(o)),m.settings.toolbar.close&&(u=v("<span>").addClass([p,"toolbar-icon ",p,"close"].join("")),v("<a>").addClass([p,"toolbar-link"].join("")).attr({href:"#"}).click(function(e){return e&&e.preventDefault&&e.preventDefault(),g._closeOverlay.call(g,i,this),!1}).append(u).appendTo(o)),o.appendTo(s),s.dblclick(function(e){(m.settings.maximized?g._restoreOverlay:g._maximizeOverlay).call(g,i,this)}),n.css({width:m.settings.width+"px",height:m.settings.height+"px"}),m.settings.draggable||m.settings.resizable||(n.css({webkitTransitionProperty:"top, left",webkitTransitionDuration:"1000ms"}),v(window).bind("resize.overlay",function(){g._onWindowResize.call(g,i)}).bind("scroll.overlay",function(){g._onWindowResize.call(g,i)})),m.settings.header?s.appendTo(n):a.css("top",0),a.appendTo(n),m.settings.footer?l.appendTo(n):a.css("bottom",0),t.appendTo(e),n.appendTo(e),e.appendTo(document.body),m.settings.draggable){if(v.fn.zinoDraggable===f)throw new Error("zinoDraggable is missing.");n.zinoDraggable({handle:s,lowerBound:null,upperBound:null,start:function(e,t){c.trigger("overlaydragstart",{event:e,ui:t})},drag:function(e,t){c.trigger("overlaydrag",{event:e,ui:t})},end:function(e,t){c.trigger("overlaydragend",{event:e,ui:t})},attachLater:!1}),s.css({cursor:"move"})}if(v(document).bind("keydown.overlay",function(e){27===(e.charCode||e.keyCode||0)&&g.curInst&&g.curInst._closeOverlay.call(g,i)}),m.$wrapper=t,m.$holder=n,m.$container=e,v.data(i,y,m),m.settings.autoOpen&&g._openOverlay.call(g,i),m.settings.resizable){if(v.fn.zinoResizable===f)throw new Error("zinoResizable is missing.");n.zinoResizable({resize:function(){c.trigger("overlayresize",{})},start:function(){c.trigger("overlayresizestart",{})},end:function(){c.trigger("overlayresizeend",{})},maxWidth:m.settings.maxWidth,maxHeight:m.settings.maxHeight,minWidth:m.settings.minWidth,minHeight:m.settings.minHeight})}},_setPosition:function(e){e=this._getInst(e);if(!e)return z;var t=w(),i=b();v("#zui-overlay-holder-"+e.uid).css({top:[t.top+(i.height-e.settings.height)/2,"px"].join(""),left:[t.left+(i.width-e.settings.width)/2,"px"].join("")})},_setSize:function(e){e=this._getInst(e);if(!e)return z;var t=w(),i=b();v("#zui-overlay-container-"+e.uid).css({height:[t.top+i.height,"px"].join(""),width:[t.left+i.width,"px"].join("")}),v("#zui-overlay-wrapper-"+e.uid).css({height:[Math.max(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),Math.max(document.body.clientHeight,document.documentElement.clientHeight)),"px"].join(""),width:[Math.max(Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),Math.max(document.body.clientWidth,document.documentElement.clientWidth)),"px"].join("")})},_onWindowResize:function(e){var t=this._getInst(e);if(!t)return z;t.isOpen&&(this._setPosition(e),this._setSize(e))},_showResizableHandles:function(e){e=this._getInst(e);if(!e)return z;v(".zui-resizable-handle",e.$container).show()},_hideResizableHandles:function(e){e=this._getInst(e);if(!e)return z;v(".zui-resizable-handle",e.$container).hide()},_openOverlay:function(e){var t,i=this._getInst(e);return i?(t=this,v(e),t.curInst=t,null!==i.settings.beforeOpen&&!1===i.settings.beforeOpen.call(e,i)?t:(t._setSize(e),t._setPosition(e),v("#zui-overlay-wrapper-"+i.uid).css({display:i.settings.modal?"block":"none"}),v("#zui-overlay-container-"+i.uid).show(),v(e).trigger("overlayopen",{}),i.isOpen=!0,void v.data(e,y,i))):z},_closeOverlay:function(e){var t=this._getInst(e);return t?null!==t.settings.beforeClose&&!1===t.settings.beforeClose.call(e,t)?this:(v("#zui-overlay-container-"+t.uid).hide(),v(e).trigger("overlayclose",{}),this.body&&(this.body.style.overflow=this.overflow_body),this.html&&(this.html.style.overflow=this.overflow_html),this.curInst=null,t.isOpen=!1,void v.data(e,y,t)):z},_minimizeOverlay:function(e){var t,i,n=this._getInst(e);if(!n)return z;n.isOpen&&(i=(t=document.getElementById("zui-overlay-header-"+n.uid)).offsetHeight,n.settings.maximized||(this.last_width=n.settings.width,this.last_height=n.settings.height),n.settings.resizable&&this._hideResizableHandles.call(this,e),this.body&&(this.body.style.overflow=this.overflow_body),this.html&&(this.html.style.overflow=this.overflow_html),v("#zui-overlay-content-"+n.uid).hide(),n.settings.footer&&v("#zui-overlay-footer-"+n.uid).hide(),v(".zui-overlay-minimize",t).parent().hide(),v(".zui-overlay-maximize",t).parent().show(),v(".zui-overlay-restore",t).parent().show(),v("#zui-overlay-holder-"+n.uid).css({height:i+"px"}),n.settings.maximized=!1,n.settings.minimized=!0,v(e).trigger("overlayminimize",{}),v.data(e,y,n))},_maximizeOverlay:function(e){var t,i,n,s=this._getInst(e);if(!s)return z;s.isOpen&&(t=b(),i=w(),n=document.getElementById("zui-overlay-header-"+s.uid),s.settings.minimized||(this.last_width=s.settings.width,this.last_height=s.settings.height),s.settings.width=t.width,s.settings.height=t.height,v("#zui-overlay-holder-"+s.uid).css({height:t.height+"px",width:t.width+"px"}),s.settings.maximized=!0,s.settings.minimized=!1,v(".zui-overlay-minimize",n).parent().show(),v(".zui-overlay-maximize",n).parent().hide(),v(".zui-overlay-restore",n).parent().show(),s.settings.resizable&&this._hideResizableHandles(this,e),this.body&&(this.body.style.overflow="hidden"),this.html&&(this.html.style.overflow="hidden"),v("#zui-overlay-content-"+s.uid).show(),s.settings.footer&&v("#zui-overlay-footer-"+s.uid).show(),v("#zui-overlay-holder-"+s.uid).css({top:i.top+"px",left:i.left+"px"}),v(e).trigger("overlaymaximize",{}),v.data(e,y,s))},_restoreOverlay:function(e){var t,i,n,s=this._getInst(e);if(!s)return z;s.isOpen&&(t=this.last_width,i=this.last_height,n=document.getElementById("zui-overlay-header-"+s.uid),s.settings.minimized?s.settings.minimized=!1:s.settings.maximized?s.settings.maximized=!1:(this.last_width=s.settings.width,this.last_height=s.settings.height),s.settings.resizable&&this._showResizableHandles.call(this,e),s.settings.width=t,s.settings.height=i,this.body&&(this.body.style.overflow=this.overflow_body),this.html&&(this.html.style.overflow=this.overflow_html),v("#zui-overlay-holder-"+s.uid).css({width:t+"px",height:i+"px"}),v("#zui-overlay-content-"+s.uid).show(),s.settings.footer&&v("#zui-overlay-footer-"+s.uid).show(),v(".zui-overlay-minimize",n).parent().show(),v(".zui-overlay-maximize",n).parent().show(),v(".zui-overlay-restore",n).parent().hide(),this._setPosition(e),v(e).trigger("overlayrestore",{}),v.data(e,y,s))},_newInst:function(e){return{id:e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:e,uid:Math.floor(999999*Math.random()),isDisabled:z,isOpen:z,settings:{}}},_getInst:function(e){try{return v.data(e,y)}catch(e){throw"Missing instance data for this overlay"}}},v.fn.zinoOverlay=function(e){var t=Array.prototype.slice.call(arguments,1);return"string"==typeof e&&"isDisabled"===e||"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?v.zinoOverlay["_"+e+"Overlay"].apply(v.zinoOverlay,[this[0]].concat(t)):this.each(function(){"string"==typeof e?v.zinoOverlay["_"+e+"Overlay"].apply(v.zinoOverlay,[this].concat(t)):v.zinoOverlay._attachOverlay(this,e)})},v.zinoOverlay=new e,v.zinoOverlay.version="1.5"}(jQuery);