!function(s,r){"use strict";var l="draggable",g=!1;function t(){this._defaults={handle:null,lowerBound:null,upperBound:null,attachLater:!1,start:null,drag:null,end:null,enable:null,disable:null},this._internal={cursorStartPos:null,elementStartPos:null,dragging:!1,listening:!1,disposed:!1}}t.prototype={_attachDraggable:function(e,t){if(this._getInst(e))return g;var n=s(e),a=this,i=a._newInst(n);s.extend(i.settings,a._defaults,t),s.extend(i.internal,a._internal),null!==i.settings.lowerBound&&zino.Position!==r&&(i.settings.lowerBound=new zino.Position(i.settings.lowerBound[0],i.settings.lowerBound[1])),null!==i.settings.upperBound&&zino.Position!==r&&(i.settings.upperBound=new zino.Position(i.settings.upperBound[0],i.settings.upperBound[1])),"string"==typeof i.settings.handle&&0<i.settings.handle.length&&(i.settings.handle=s(i.settings.handle,e)),i.$handle=null!==i.settings.handle?i.settings.handle:n,null!=i.settings.lowerBound&&null!=i.settings.upperBound&&(t=i.settings.lowerBound.min(i.settings.upperBound),i.settings.upperBound=i.settings.lowerBound.max(i.settings.upperBound),i.settings.lowerBound=t),n.addClass("zui-draggable").css("position","absolute").bind("draggablestart",function(t,n){null!==i.settings.start&&i.settings.start.call(e,t,n)}).bind("draggabledrag",function(t,n){null!==i.settings.drag&&i.settings.drag.call(e,t,n)}).bind("draggableend",function(t,n){null!==i.settings.end&&i.settings.end.call(e,t,n)}).bind("draggableenable",function(t,n){null!==i.settings.enable&&i.settings.enable.call(e,t,n)}).bind("draggabledisable",function(t,n){null!==i.settings.disable&&i.settings.disable.call(e,t,n)}),s.data(e,l,i),i.settings.attachLater||a._startListening.call(a,e)},_enableDraggable:function(t){var n=this._getInst(t);if(!n)return g;n.isDisabled&&(n.isDisabled=g,this._startListening.call(this,t),s(t).trigger("draggableenable",{}),s.data(t,l,n))},_disableDraggable:function(t){var n=this._getInst(t);if(!n)return g;n.isDisabled||(n.isDisabled=!0,this._stopListening.call(this,t,!0),s(t).trigger("draggabledisable",{}),s.data(t,l,n))},_dragStart:function(n,t){var e,a,i=this._getInst(n);return i?(e=this,a=s(n),i.internal.dragging||!i.internal.listening||i.internal.disposed?void 0:(i.internal.dragging=!0,a.trigger("draggablestart",{handle:i.$handle.get(0)}),i.internal.cursorStartPos=zino.Position.getCursor(t),i.internal.elementStartPos=new zino.Position(parseInt(a.css("left")),parseInt(a.css("top"))),i.internal.elementStartPos=i.internal.elementStartPos.check(),a.focus(),s(document).bind("mousemove.draggable",function(t){e._dragGo.call(e,n,t)}).bind("mouseup.draggable",function(t){e._dragStopHook.call(e,n,t)}),s.data(n,l,i),t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),!1)):g},_dragGo:function(t,n){var e=this._getInst(t);return e?(t=s(t),e.internal.dragging&&!e.internal.disposed?(zino.Position.getCursor(n).add(e.internal.elementStartPos).subtract(e.internal.cursorStartPos).bound(e.settings.lowerBound,e.settings.upperBound).apply(t),t.trigger("draggabledrag",{handle:e.$handle.get(0)}),n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault(),!1):void 0):g},_dragStopHook:function(t,n){return this._getInst(t)?(this._dragStop.call(this,t,n),n.stopPropagation&&n.stopPropagation(),n.preventDefault&&n.preventDefault(),!1):g},_dragStop:function(n,t){var e=this._getInst(n);if(!e)return g;var a=this,i=s(n);e.internal.dragging&&!e.internal.disposed&&(s(document).unbind("mousemove.draggable",function(t){a._dragGo.call(a,n,t)}),s(document).unbind("mouseup.draggable",function(t){a._dragStopHook.call(a,n,t)}),e.internal.cursorStartPos=null,e.internal.elementStartPos=null,i.trigger("draggableend",{handle:e.$handle.get(0)}),e.internal.dragging=!1,s.data(n,l,e))},_destroyDraggable:function(t){var n=this._getInst(t);if(!n)return g;n.internal.disposed||(s(t).removeClass("zui-draggable"),this._stopListening.call(this,t,!0),s.data(t,l,null))},_startListening:function(n){var t=this._getInst(n);if(!t)return g;var e=this;t.internal.listening||t.internal.disposed||(t.internal.listening=!0,t.$handle.bind("mousedown.draggable",function(t){e._dragStart.call(e,n,t)}),s.data(n,l,t))},_stopListening:function(n,t){var e=this._getInst(n);if(!e)return g;var a=this;e.internal.listening&&!e.internal.disposed&&(e.$handle.unbind("mousedown.draggable",function(t){a._dragStart.call(a,n,t)}),e.internal.listening=!1,t&&e.internal.dragging&&a._dragStop.call(a,n),s.data(n,l,e))},_isDragging:function(t){return t?this._getInst(t).internal.dragging:g},_isListening:function(t){return t?this._getInst(t).internal.listening:g},_isDisposed:function(t){return t?this._getInst(t).internal.disposed:g},_newInst:function(t){return{id:t[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:t,uid:Math.floor(99999999*Math.random()),isDisabled:g,settings:{},internal:{}}},_getInst:function(t){try{return s.data(t,l)}catch(t){throw"Missing instance data for this draggable"}}},s.fn.zinoDraggable=function(t){var n=Array.prototype.slice.call(arguments,1);return"string"==typeof t&&"isDisabled"===t||"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?s.zinoDraggable["_"+t+"Draggable"].apply(s.zinoDraggable,[this[0]].concat(n)):this.each(function(){"string"==typeof t?s.zinoDraggable["_"+t+"Draggable"].apply(s.zinoDraggable,[this].concat(n)):s.zinoDraggable._attachDraggable(this,t)})},s.zinoDraggable=new t,s.zinoDraggable.version="1.5"}(jQuery);