!function(c){"use strict";var i="treeview",l=!1;function e(){this._defaults={dataSource:null,easing:"linear",expandDuration:350,collapseDuration:"fast",expand:null,collapse:null,select:null,remove:null}}e.prototype={_attachTreeview:function(n,e){if(this._getInst(n))return l;var t=c(n),s=this,o=s._newInst(t);c.extend(o.settings,s._defaults,e),t.addClass("zui-treeview zui-unselectable").append(c("<ul>").attr({role:"tree","aria-labelledby":"",tabindex:0}).addClass("zui-treeview-list-root")),c.data(n,i,o);var v,u=1;o.settings.dataSource.load(function(e){!function e(t,i,r){for(var a=0,l=t.length;a<l;a++)t[a].parent_id===i&&(v=["zui-treeview-label-",o.uid,"-",u].join(""),v=c("<li>").attr({role:"treeitem",tabindex:-1,"aria-expanded":!1,"aria-labelledby":v}).addClass("zui-treeview-item").append(c("<div>").attr("id",v).addClass("zui-treeview-label").html(t[a].text)).append(c("<ul>").attr("role","group").addClass("zui-treeview-list")),t[a].expanded&&s._expandTreeview.call(s,n,v),t[a].selected&&s._selectTreeview.call(s,n,v),v.appendTo(r.children("ul")),u+=1,e(t,t[a].id,v))}(e,0,t),t.find(".zui-treeview-label").each(function(e,t){var t=c(t),i=t.siblings("ul"),r=t.parent("li");0<i.children().length?t.before(c("<span>").attr("role","presentation").addClass("zui-treeview-arrow").addClass("false"===r.attr("aria-expanded")?"zui-treeview-arrow-collapse":"zui-treeview-arrow-expand")):i.remove()})}),t.on("mouseover.treeview",".zui-treeview-label",function(){c(this).addClass("zui-treeview-label-hover")}).on("mouseout.treeview",".zui-treeview-label",function(){c(this).removeClass("zui-treeview-label-hover")}).on("click.treeview",".zui-treeview-label",function(){s._selectTreeview.call(s,n,c(this).parent("li"))}).on("dblclick.treeview",".zui-treeview-label",function(){var e=c(this).siblings("ul").eq(0);(e.is(":visible")?s._collapseTreeview:s._expandTreeview).call(s,n,e.parent("li"))}).on("click.treeview",".zui-treeview-arrow-collapse",function(){s._expandTreeview.call(s,n,c(this).parent("li"))}).on("click.treeview",".zui-treeview-arrow-expand",function(){s._collapseTreeview.call(s,n,c(this).parent("li"))}).on("keydown.treeview","li",function(e){switch(e.stopPropagation(),e.charCode||e.keyCode||0){case 37:e.preventDefault(),s._collapseTreeview.call(s,n,c(e.target));break;case 38:e.preventDefault();var t=s._getPrevTreeview.call(s,n,s._getSelectedTreeview.call(s,n));s._selectTreeview.call(s,n,t);break;case 39:e.preventDefault(),s._expandTreeview.call(s,n,c(e.target));break;case 40:e.preventDefault();t=s._getNextTreeview.call(s,n,s._getSelectedTreeview.call(s,n));t.hasClass("zui-treeview-item")&&"LI"===t.get(0).nodeName&&s._selectTreeview.call(s,n,t);break;case 13:case 32:case 9:e.preventDefault()}return!0}).bind("treeviewexpand",function(e,t){null!==o.settings.expand&&o.settings.expand.call(n,e,t)}).bind("treeviewcollapse",function(e,t){null!==o.settings.collapse&&o.settings.collapse.call(n,e,t)}).bind("treeviewselect",function(e,t){null!==o.settings.select&&o.settings.select.call(n,e,t)}).bind("treeviewremove",function(e,t){null!==o.settings.remove&&o.settings.remove.call(n,e,t)}),c.data(n,i,o)},_collapseTreeview:function(e,t){var i=this._getInst(e);if(!i||0===t.length)return l;t.attr("aria-expanded",!1).children("span").removeClass("zui-treeview-arrow-expand").addClass("zui-treeview-arrow-collapse").end().children("ul").slideUp(i.settings.collapseDuration,i.settings.easing),0!==t.children("ul").length&&t.children("ul").is(":visible")||0<(i=t.closest(".zui-treeview-list").closest(".zui-treeview-item")).length&&this._selectTreeview.call(this,e,i),c(e).trigger("treeviewcollapse",{item:t})},_expandTreeview:function(e,t){var i=this._getInst(e);if(!i||0===t.length)return l;t.attr("aria-expanded",!0).children("span").removeClass("zui-treeview-arrow-collapse").addClass("zui-treeview-arrow-expand").end().children("ul").slideDown(i.settings.expandDuration,i.settings.easing),c(e).trigger("treeviewexpand",{item:t})},_collapseAllTreeview:function(e){if(!this._getInst(e))return l;c(".zui-treeview-item",e).attr("aria-expanded",!1),c(".zui-treeview-arrow",e).removeClass("zui-treeview-arrow-expand").addClass("zui-treeview-arrow-collapse"),c(".zui-treeview-list",e).slideUp()},_expandAllTreeview:function(e){if(!this._getInst(e))return l;c(".zui-treeview-item",e).attr("aria-expanded",!0),c(".zui-treeview-arrow",e).removeClass("zui-treeview-arrow-collapse").addClass("zui-treeview-arrow-expand"),c(".zui-treeview-list",e).slideDown()},_removeTreeview:function(e,t){if(!this._getInst(e)||0===t.length)return l;t.remove(),c(e).trigger("treeviewremove",{item:t})},_getSelectedTreeview:function(e){return this._getInst(e)?c(".zui-treeview-label-selected",e).parent():l},_getPrevTreeview:function(e,t){return this._getInst(e)&&t&&0!==t.length?(e=t.prev(),t=t.parent().parent(),0===e.length&&t.is("li")&&t.hasClass("zui-treeview-item")?t:e.has(".zui-treeview-list")&&"true"===e.attr("aria-expanded")?e.find(".zui-treeview-item").filter(":visible").last():e):l},_getNextTreeview:function(e,t){var i,r,a;return this._getInst(e)&&t&&0!==t.length?(e=t.next(),i=t.has(".zui-treeview-list"),r=t.attr("aria-expanded"),0!==e.length||i&&"false"!==r?i&&"true"===r?t.find(".zui-treeview-item").filter(":visible").first():e:(function e(t){var t=t.parent().parent(),i=t.next();0===i.length?e(t):a=i}(t),a)):l},_selectTreeview:function(e,t){if(!this._getInst(e)||!t||0===t.length)return l;c(".zui-treeview-label",e).removeClass("zui-treeview-label-selected"),c(".zui-treeview-item",e).attr("tabindex",-1),t.attr("tabindex",0).focus().children(".zui-treeview-label").addClass("zui-treeview-label-selected"),c(e).trigger("treeviewselect",{item:t})},_newInst:function(e){return{id:e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1"),input:e,uid:Math.floor(99999999*Math.random()),isDisabled:l,settings:{}}},_getInst:function(e){try{return c.data(e,i)}catch(e){throw"Missing instance data for this treeview"}}},c.fn.zinoTreeview=function(e){var t=Array.prototype.slice.call(arguments,1);return"string"==typeof e&&c.inArray(e,["isDisabled","getSelected","getNext","getPrev"])||"option"===e&&2===arguments.length&&"string"==typeof arguments[1]?c.zinoTreeview["_"+e+"Treeview"].apply(c.zinoTreeview,[this[0]].concat(t)):this.each(function(){"string"==typeof e?c.zinoTreeview["_"+e+"Treeview"].apply(c.zinoTreeview,[this].concat(t)):c.zinoTreeview._attachTreeview(this,e)})},c.zinoTreeview=new e,c.zinoTreeview.version="1.5.1"}(jQuery);